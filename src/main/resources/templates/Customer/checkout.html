<!DOCTYPE html>
<html>
<head>
    <title>Thanh toán</title>
    <link rel="stylesheet" href="/css/customer.css">
</head>
<body>

<div class="container">
    <h2>Thông tin giao hàng</h2>

    <input id="name" placeholder="Họ tên">
    <input id="phone" placeholder="Số điện thoại">
    <input id="address" placeholder="Địa chỉ">

    <button class="btn" onclick="createOrder()">Đặt hàng</button>
</div>

<script>
    const USER_ID = "04bb5c42-be82-11f0-b892-141333f7b42a";
    const RESTAURANT_ID = "9e895695-d112-436a-8cbf-4702af29ccdb";

    function createOrder() {
        let cart = JSON.parse(localStorage.getItem("cart") || "[]");

        let items = cart.map(i => ({
            menuItemId: i.id,
            quantity: i.qty
        }));

        let body = {
            userId: USER_ID,
            restaurantId: RESTAURANT_ID,
            customerName: document.getElementById("name").value,
            customerPhone: document.getElementById("phone").value,
            customerAddress: document.getElementById("address").value,
            items: items
        };

        fetch("/api/orders", {
            method: "POST",
            headers: {"Content-Type": "application/json"},
            body: JSON.stringify(body)
        })
            .then(res => res.json())
            .then(data => {
                alert("Đặt hàng thành công!");
                localStorage.removeItem("cart");
                location.href = "/customer/orders";
            });
    }
</script>

</body>
</html>

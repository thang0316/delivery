<h3>ÄÆ¡n hÃ ng cá»§a báº¡n</h3>

<div id="ordersBox">Äang táº£i...</div>

<script>
    /* ===============================
           LOAD USER FORMAT CÅ¨
    =============================== */
    function getUser(){
        return JSON.parse(localStorage.getItem("user") || "{}");
    }

    /* ===============================
                LOAD ORDERS
    =============================== */
    async function loadOrders(){
        let user = getUser();

        if(!user.id){
            ordersBox.innerHTML = "<p class='text-danger'>KhÃ´ng xÃ¡c Ä‘á»‹nh Ä‘Æ°á»£c ngÆ°á»i dÃ¹ng!</p>";
            return;
        }

        const r = await fetch(`/api/orders/user/${user.id}`);
        const list = await r.json();

        if(!Array.isArray(list) || list.length === 0){
            ordersBox.innerHTML = "<p class='text-muted'>ChÆ°a cÃ³ Ä‘Æ¡n hÃ ng nÃ o.</p>";
            return;
        }

        let html = "";

        list.forEach(o=>{
            let date = o.createdAt ? new Date(o.createdAt).toLocaleString("vi-VN") : "KhÃ´ng rÃµ";

            html += `
        <div class="border rounded p-3 mb-3">
            <h5>ÄÆ¡n #${o.id}</h5>
            <p>ğŸ“Œ Tráº¡ng thÃ¡i:
                <b class="text-primary">${o.status}</b>
            </p>
            <p>ğŸ’° Tá»•ng tiá»n:
                <b class="text-danger">${o.totalAmount.toLocaleString()}Ä‘</b>
            </p>
            <p>ğŸ•’ NgÃ y táº¡o: ${date}</p>
        </div>`;
        });

        ordersBox.innerHTML = html;
    }

    loadOrders();
</script>
